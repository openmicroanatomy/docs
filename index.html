<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="v1.0 draft, 28.1.2023">
<title>OpenMicroanatomy Handbook</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>OpenMicroanatomy Handbook</h1>
<div class="details">
<span id="author" class="author">v1.0 draft, 28.1.2023</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction_to_openmicroanatomy">Introduction to OpenMicroanatomy</a>
<ul class="sectlevel2">
<li><a href="#_what_is_openmicroanatomy">What is OpenMicroanatomy</a></li>
<li><a href="#_hierarchy">Hierarchy</a></li>
</ul>
</li>
<li><a href="#_getting_started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#_feature_comparison">Feature comparison</a></li>
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_installing_qupath_edu_extension">Installing QuPath Edu Extension</a></li>
</ul>
</li>
<li><a href="#_qupath_edu_extension">QuPath Edu Extension</a>
<ul class="sectlevel2">
<li><a href="#_connecting_authenticating">Connecting &amp; authenticating</a>
<ul class="sectlevel3">
<li><a href="#_first_time_setup">First time setup</a></li>
<li><a href="#_logging_in">Logging in</a></li>
<li><a href="#_password_recovery">Password recovery</a></li>
</ul>
</li>
<li><a href="#_creating_content">Creating content</a>
<ul class="sectlevel3">
<li><a href="#_creating_workspaces_courses_and_lessons">Creating workspaces, courses and lessons</a></li>
<li><a href="#_adding_slides_to_a_lesson">Adding slides to a lesson</a></li>
<li><a href="#_making_changes_to_slides">Making changes to slides</a></li>
<li><a href="#_modify_lesson_information">Modify Lesson Information</a></li>
<li><a href="#_creating_slide_tours">Creating slide tours</a></li>
</ul>
</li>
<li><a href="#_administrative_tasks">Administrative tasks</a>
<ul class="sectlevel3">
<li><a href="#_users_roles">Users &amp; Roles</a></li>
<li><a href="#_slides">Slides</a></li>
<li><a href="#_backups">Backups</a></li>
<li><a href="#_organizations">Organizations</a></li>
<li><a href="#_permissions">Permissions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_openmicroanatomy_cloud">OpenMicroanatomy Cloud</a></li>
<li><a href="#_openmicroanatomy_server">OpenMicroanatomy Server</a>
<ul class="sectlevel2">
<li><a href="#_installation_running">Installation &amp; Running</a>
<ul class="sectlevel3">
<li><a href="#_installation_docker">Installation (Docker)</a></li>
<li><a href="#_installation_manually">Installation (Manually)</a></li>
</ul>
</li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_ssl">SSL</a>
<ul class="sectlevel3">
<li><a href="#_no_existing_reverse_proxy">No existing reverse proxy</a></li>
<li><a href="#_existing_reverse_proxy">Existing reverse proxy</a></li>
</ul>
</li>
<li><a href="#_troubleshooting">Troubleshooting</a>
<ul class="sectlevel3">
<li><a href="#_fixing_incorrect_slide_paths">Fixing Incorrect Slide Paths</a></li>
</ul>
</li>
<li><a href="#_http_api">HTTP API</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>This documentation is currently work in progress</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
QuPath Edu Server and Cloud were recently renamed to OpenMicroanatomy Server and OpenMicroanatomy Cloud. QuPath Edu Extension continues with the previous name.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_openmicroanatomy">Introduction to OpenMicroanatomy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_openmicroanatomy">What is OpenMicroanatomy</h3>
<div class="paragraph">
<p>OpenMicroanatomy is a project built on top of QuPath which contains three components: <strong>OpenMicroanatomy Server</strong>, <strong>OpenMicroanatomy Cloud</strong> and <strong>QuPath Edu Extension</strong>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/openmicroanatomy/qupath-extension"><strong>QuPath Edu Extension</strong></a> is an extension for <a href="https://qupath.github.io/">QuPath</a>, which allows QuPath projects (called <em>Lessons</em> in QuPath Edu) to be synced between multiple users via an <a href="https://github.com/openmicroanatomy/server"><strong>OpenMicroanatomy Server</strong></a>. The <strong>OpenMicroanatomy Server</strong> handles all the heavy lifting required to authenticate users, upload new slides, manage data and so on. <em>QuPath Edu</em> is also compatible with other data sources, such as <a href="https://github.com/qupath/qupath-extension-omero">Omero</a>.</p>
</div>
<div class="paragraph">
<p>OpenMicroanatomy also includes <a href="https://github.com/openmicroanatomy/web"><strong>OpenMicroanatomy Cloud</strong></a>, which is a web application that communicates with a <strong>OpenMicroanatomy Server</strong> and can be used for <strong>viewing</strong> projects.</p>
</div>
<div id="img-components" class="imageblock">
<div class="content">
<img src="images/Components.png" alt="Components">
</div>
<div class="title">Figure 1. Visual representation of different OpenMicroanatomy components and how they communicate with each other. Green components are downloaded by the end-user and the blue components are set up by the system administrator. Red are optional third-party features.</div>
</div>
</div>
<div class="sect2">
<h3 id="_hierarchy">Hierarchy</h3>
<div class="paragraph">
<p>A <strong>OpenMicroanatomy Server</strong> is <em>“compartmentalized”</em> as shown in <strong>Figure 2.</strong> Each server can host one or multiple <em>Organizations</em>. Each organization has its own <em>Workspaces</em>, which hold <em>Classes</em>, which contain the <em>Lessons</em>. See <strong>Table 1</strong> for how to think about these.</p>
</div>
<div id="img-hierarchy" class="imageblock">
<div class="content">
<img src="images/Hierarchy.png" alt="Hierarchy">
</div>
<div class="title">Figure 2. A demonstration of the OpenMicroanatomy hierarchy, with a server with three different organizations.</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Translations for different OpenMicroanatomy components</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Translation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents a university, school, department, or such – depending on your needs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A course, such as <em>Histology</em> or <em>Pathology</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class such as <em>Basic Histology</em> or <em>Advanced Histology</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lesson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A lesson within that class, such as <em>Epithelium</em> or <em>Connective tissue</em>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_feature_comparison">Feature comparison</h3>
<div class="paragraph">
<p>✅ = supported ❌ = not supported <em>(and currently no plans to implement)</em> 👷‍♀ = work in progress</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Browser / Mobile</th>
<th class="tableblock halign-left valign-top">Desktop app</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View slides</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slide tours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅️</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_creating_content">Creating content</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">❌</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_administrative_tasks">Administrative tasks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">❌</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">👷‍♀️</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_prerequisites">Prerequisites</h3>
<div class="paragraph">
<p><strong>QuPath &amp; QuPath Edu Extension</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>A 64-bit Windows, macOS or Linux machine, with at least 250 MB of disk space</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>OpenMicroanatomy Cloud</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>None</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>OpenMicroanatomy Server</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#_openmicroanatomy_server">OpenMicroanatomy Server</a> chapter.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_installing_qupath_edu_extension">Installing QuPath Edu Extension</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install <a href="https://qupath.readthedocs.io/en/stable/docs/intro/installation.html">QuPath</a> by following the instructions on the QuPath website</p>
</li>
<li>
<p>Download the <a href="https://github.com/yli-hallila/qupath-edu-extension/releases">QuPath Edu extension</a></p>
</li>
<li>
<p>Install the extension by drag and dropping the downloaded <code>.jar</code> file to the QuPath viewer</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>See <a href="https://github.com/qupath/qupath/wiki/Creating-extensions#installing-extensions">here</a> for more detailed instructions on how to install QuPath extensions</em></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_qupath_edu_extension">QuPath Edu Extension</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_connecting_authenticating">Connecting &amp; authenticating</h3>
<div class="sect3">
<h4 id="_first_time_setup">First time setup</h4>
<div class="paragraph">
<p>When starting QuPath Edu for the first time, you&#8217;ll see the <em>First-time setup</em> dialog. You must either select a <em>public host</em> or enter your <strong>QuPath Edu Servers</strong> address to continue. If you are unsure what your institutions address is, try contacting your IT-services. Public hosts are QuPath Edu Servers which can be freely viewed by anyone. Currently the only public host is the demo server provided by the University of Oulu.</p>
</div>
<div id="img-setup" class="imageblock">
<div class="content">
<img src="images/Setup.png" alt="First Time Setup">
</div>
<div class="title">Figure 3. First-time setup dialog</div>
</div>
<div class="paragraph">
<p>You can change your host later by clicking the <strong>Change host &#8230;&#8203;</strong> link on the <strong>Login dialog</strong> (see <a href="#img-login">Figure 4</a>) or from the QuPath settings <span class="menuseq"><b class="menu">Edit</b>&#160;<b class="caret">&#8250;</b> <b class="submenu">Preferences</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Edu</b></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_logging_in">Logging in</h4>
<div class="paragraph">
<p>You can continue either <strong>Continue as a guest</strong> <em>(only read permissions)</em> or authenticate using <strong>Credentials</strong> <em>(regular email &amp; password combination)</em> or a <strong>Microsoft account</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Logging in using Credentials and/or Microsoft Authentication may not be available on your organization depending on your <em>OpenMicroanatomy Server</em> setup.
</td>
</tr>
</table>
</div>
<div id="img-login" class="imageblock">
<div class="content">
<img src="images/Login.png" alt="Login dialog">
</div>
<div class="title">Figure 4. Login dialog. Change host by pressing the <b class="button">Change host &#8230;&#8203;</b> on the bottom-right hand corner.</div>
</div>
</div>
<div class="sect3">
<h4 id="_password_recovery">Password recovery</h4>
<div class="paragraph">
<p>If you forgot your password, you can recover your password by pressing <b class="button">Login with credentials</b> and then <b class="button">Forgot password</b> from the bottom right-hand corner.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_content">Creating content</h3>
<div class="paragraph">
<p>Going further, it&#8217;s assumed the reader is already familiar with QuPath. If you have never used QuPath before, it&#8217;s advised to read the <a href="https://qupath.readthedocs.io/en/stable/">QuPath documentation</a> first.</p>
</div>
<div class="paragraph">
<p>Before making changes anywhere, confirm that you have <strong>Editing mode enabled</strong> by pressing <b class="button">Turn editing on</b> on the QuPath toolbar (see <a href="#img-toolbar">Figure 5</a> below). If any button is disabled, try checking first that <strong>a)</strong> edit mode is enabled, <strong>b)</strong> you&#8217;re logged in <strong>b)</strong>, you have the required permissions to make changes (see <a href="#_users_roles">Users &amp; Roles</a>).</p>
</div>
<div id="img-toolbar" class="imageblock">
<div class="content">
<img src="images/Toolbar.png" alt="Toolbar">
</div>
<div class="title">Figure 5. QuPath Toolbar. Notice how the annotation tools are disabled because editing mode is not turned on.</div>
</div>
<div class="sect3">
<h4 id="_creating_workspaces_courses_and_lessons">Creating workspaces, courses and lessons</h4>
<div class="paragraph">
<p>Begin by opening the <strong>Select lesson</strong> (see <a href="#img-select-lesson">Figure 7</a> below) interface by pressing either <b class="button">Open lesson</b> or <b class="button">Create lesson</b> buttons in the main QuPath interface on the left sidebar (see <a href="#img-create-lesson">Figure 6</a> below).</p>
</div>
<div id="img-create-lesson" class="imageblock">
<div class="content">
<img src="images/Left-Sidebar.png" alt="Open or create lesson">
</div>
<div class="title">Figure 6. Buttons to open and create lesson, and add images</div>
</div>
<div id="img-select-lesson" class="imageblock">
<div class="content">
<img src="images/Select-Lesson.png" alt="Select lesson dialog">
</div>
<div class="title">Figure 7. <strong>1</strong>: A workspace named <em>Anatomy</em>. <strong>2</strong>: Two courses named <em>Course materials</em> and <em>Additional materials</em>. <strong>3</strong>: Five lessons belonging to the <em>Course materials</em> course. <strong>4</strong>: Create a workspace, course or a lesson.</div>
</div>
<div class="paragraph">
<p>Create new workspaces by pressing <b class="button">Create &#8230;&#8203;</b> and selecting either <code>Workspace</code>, <code>Course</code> or <code>Lesson</code>. <code>Course</code> and <code>Lesson</code> are disabled until you select a <code>Workspace</code>.</p>
</div>
<div class="paragraph">
<p><strong>Delete or rename</strong> any <code>Workspace</code>, <code>Lesson</code> or <code>Class</code> by right-clicking on it. You can also <strong>hide</strong> Classes  or set a <strong>description</strong>. Hiding a Class will hide that Class from guests and users without write permissions. Deleting a Workspace will delete all Lessons and Classes belonging to that Workspace and similarly deleting a Lesson will delete all Classes belonging to that Lesson.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Deleting a workspace, lesson or class is currently not reversible. See <a href="#_backups">Backups</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_adding_slides_to_a_lesson">Adding slides to a lesson</h4>
<div class="paragraph">
<p>To add a new slide click on <b class="button">Add images</b> (next to <b class="button">Open lesson</b>, see <a href="#img-create-lesson">Figure 6</a> above) to open the <strong>Slide manager</strong> interface. From here, select any slide you wish to add and click on <b class="button">Add selected</b>. This will open the <strong>QuPath Image Import</strong> interface. These settings are important if you&#8217;re planning on doing any analysis on the slides later. The default options and setting the <strong>Image type</strong> to <strong>Brightfield (H-DAB)</strong> is usually enough for teaching purposes. Clicking on <b class="button">Import</b> will add the slide to the lesson.</p>
</div>
</div>
<div class="sect3">
<h4 id="_making_changes_to_slides">Making changes to slides</h4>
<div class="paragraph">
<p>Adding annotations, modifying slide description or such work identically as in QuPath, just make sure you have <strong>enabled editing mode</strong> (see <a href="#img-toolbar">Figure 5</a>). Read the <a href="https://qupath.readthedocs.io/en/stable/docs/starting/annotating.html">QuPath documentation</a> for detailed information on annotating and such.</p>
</div>
<div class="paragraph">
<p>Any changes will be saved when either <strong>a)</strong> clicking on <span class="menuseq"><b class="menu">File</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Save</b></span> or <span class="menuseq"><b class="menu">File</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Save as</b></span>, <strong>b)</strong> changing slides, <strong>c)</strong> closing the lesson.</p>
</div>
</div>
<div class="sect3">
<h4 id="_modify_lesson_information">Modify Lesson Information</h4>
<div class="paragraph">
<p>Edit the <strong>Lesson Information</strong> by either <strong>a)</strong> double-click anywhere on the <strong>Lesson Information</strong> tab <strong>b)</strong> <span class="menuseq"><b class="menu">File</b>&#160;<b class="caret">&#8250;</b> <b class="submenu">Project&#8230;&#8203;</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Edit lesson information</b></span>.</p>
</div>
<div class="paragraph">
<p>Lesson Information supports <strong>rich text</strong>, which includes custom fonts, colors, tables, images, videos, hyperlinks and much more.</p>
</div>
<div id="img-wysiwyg-editor" class="imageblock">
<div class="content">
<img src="images/WYSIWYG-Editor.png" alt="Rich text editor">
</div>
<div class="title">Figure 8. Rich text editor.</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_slide_tours">Creating slide tours</h4>
<div class="paragraph">
<p><strong>Slide tours</strong> are a feature introduced by QuPath Edu, it allows teachers to create short guided tours of slides, going through the key points of a slide.</p>
</div>
<div id="img-create-slidetour" class="imageblock">
<div class="content">
<img src="images/Create-Slide-Tour.png" alt="Create Slide tour">
</div>
<div class="title">Figure 9. Create slide tour button on viewers top-left corner.</div>
</div>
<div class="paragraph">
<p>Slide tours consists of <strong>"frames"</strong>, which the user views one-by-one. To create a <strong>Slide tour</strong>, press on <b class="button">Create tour</b> tour on the Viewers top-left corner. Next click on <span class="menuseq"><b class="menu">More ⋮</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Create new frame</b></span>, and pan &amp; zoom on the point of interest, make any annotations you wish. Set a description for this frame by pressing <span class="menuseq"><b class="menu">More ⋮</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Edit text</b></span>. Save changes by clicking on <span class="menuseq"><b class="menu">More ⋮</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Save changes</b></span>. Create as many frames you wish by clicking <span class="menuseq"><b class="menu">More ⋮</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Create new frame</b></span> and again making any annotations, panning &amp; zooming, setting a description and saving the changes with <span class="menuseq"><b class="menu">More ⋮</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Save changes</b></span>. Preview your slide tour by clicking on <b class="button">Previous</b> and <b class="button">Next</b>.</p>
</div>
<div id="img-slidetour" class="imageblock">
<div class="content">
<img src="images/Slide-Tour.png" alt="Slide tour">
</div>
<div class="title">Figure 10. Slide tour editing interface</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_administrative_tasks">Administrative tasks</h3>
<div class="paragraph">
<p>Most administrative tools are available by selecting <span class="menuseq"><b class="menu">QuPath Edu</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">&#8230;&#8203;</b></span> from the QuPath top bar. Some administrative tasks requires access to the server and are detailed in the <a href="#_openmicroanatomy_server">OpenMicroanatomy Server</a> chapter.</p>
</div>
<div class="sect3">
<h4 id="_users_roles">Users &amp; Roles</h4>
<div class="paragraph">
<p>Manage users by opening the <strong>User management</strong> interface using <span class="menuseq"><b class="menu">QuPath Edu</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Manage users</b></span>.</p>
</div>
<div id="img-user-management" class="imageblock">
<div class="content">
<img src="images/User-Management.png" alt="User management interface">
</div>
<div class="title">Figure 11. User management interface</div>
</div>
<div class="paragraph">
<p>Users with the <strong>Administrative tasks</strong> role are able to view &amp; modify all users regardless of organization. Users with only the <strong>Manage users</strong> roles can only view &amp; modify users that belong to the users organization.</p>
</div>
<div class="paragraph">
<p>Only users with the <strong>Administrative tasks</strong> role are able to migrate users to a different organization.</p>
</div>
<div class="paragraph">
<p>Passwords are required to have at least 3 characters, no other requirements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Explanation for different roles</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manage slides</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upload new slides and delete / modify slides that are owned by the users organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manage users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create new users and edit existing users on the users organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moderator tasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create new workspaces, courses and lessons on the users organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administrative tasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All permissions, regardless of organization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_slides">Slides</h4>
<div class="paragraph">
<p>Manage slides by opening the <strong>Slide management</strong> interface using <span class="menuseq"><b class="menu">QuPath Edu</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Manage slides</b></span>.</p>
</div>
<div id="img-slide-management" class="imageblock">
<div class="content">
<img src="images/Slide-Management.png" alt="Slide management interface">
</div>
<div class="title">Figure 12. Slide management interface. Each slide has an UUID <em>(Universal Unique Identifier)</em> which distinguishes it from others.</div>
</div>
<div class="paragraph">
<p>Users with the <strong>Administrative tasks</strong> roles are able to view &amp; modify all slides regardless of organization. Users with only the <strong>Manage slides</strong> roles can only view &amp; modify slides that belong to the users organization.</p>
</div>
<div class="paragraph">
<p><strong>Import new slides</strong> by clicking the <b class="button">Import slide</b> button. QuPath verifies that the selected slide is compatible with QuPath Edu and starts uploading it. After upload the OpenMicroanatomy Server processes the slide which can take up to 30 minutes depending on the slide size and server performance.</p>
</div>
<div class="paragraph">
<p><strong>Deleting</strong> a slide will make it inaccessible from any Lesson that contains it but <strong>will not</strong> remove it from the slide listing. Deleted slides must be removed manually from each lesson also. <strong>Renaming</strong> a slide will only affect slides added in the future.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
In OpenMicroanatomy Server <strong>version 1.0</strong> deleting slides only makes them inaccessible but <strong>does not</strong> remove the data stored. It is up to the server administrator to delete any associated data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can view any slide by clicking on <b class="button">Open selected</b>. If you have a lesson open, you will be prompted to add that slide to the current project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_backups">Backups</h4>
<div class="paragraph">
<p>Manage <strong>lesson</strong> backups by opening the <strong>Backup management</strong> interface using <span class="menuseq"><b class="menu">QuPath Edu</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Manage backups</b></span>.</p>
</div>
<div class="paragraph">
<p>Restore a lesson by selecting the lesson and pressing <b class="button">Restore backup</b> or preview it first by pressing <b class="button">Preview backup</b>. Backups are automatically deleted after 30 days.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Currently there&#8217;s no way to restore a deleted workspace / class or a lesson without administrative tools. A whole database backup is performed every 24 hours, which can be used to restore any deleted workspace / class or lesson.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In QuPath Edu Server version 1.0 a bug exists, which allows users with write permissions to preview all backups regardless of organization. Restoring backups is still limited to users with proper write permissions to a specific workspace.
</td>
</tr>
</table>
</div>
<div id="img-edit-organization" class="imageblock">
<div class="content">
<img src="images/Backup-Management.png" alt="Backup management dialog">
</div>
<div class="title">Figure 13. Backup management interface.</div>
</div>
</div>
<div class="sect3">
<h4 id="_organizations">Organizations</h4>
<div class="paragraph">
<p>Manage organizations by opening the <strong>Organization management</strong> interface using <span class="menuseq"><b class="menu">QuPath Edu</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Manage organizations</b></span>.</p>
</div>
<div id="img-organization-management" class="imageblock">
<div class="content">
<img src="images/Organization-Management.png" alt="Organization management interface">
</div>
<div class="title">Figure 14. Organization management interface. Each organization has an UUID <em>(Universal Unique Identifier)</em> which distinguishes it from others.</div>
</div>
<div class="paragraph">
<p><strong>Making any changes to an organization requires the <em>Administrative tasks</em> role</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Deleting</strong> an organization will delete <strong>permanently all data</strong> associated with that project, including <strong>workspaces, lessons, courses, users, and slides</strong>.</p>
</div>
<div class="paragraph">
<p>Clicking <b class="button">Edit</b> allows you to <strong>rename</strong> and <strong>upload a logo</strong> for that organization, see <a href="#img-edit-organization">Figure 13</a>.</p>
</div>
<div class="paragraph">
<p><strong>Organization logo requirements</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>PNG filetype</p>
</li>
<li>
<p>Size of 400x80 px or greater</p>
</li>
<li>
<p>Aspect ratio of 5:1</p>
</li>
</ul>
</div>
<div id="img-edit-organization" class="imageblock">
<div class="content">
<img src="images/Edit-Organization.png" alt="Edit organization dialog">
</div>
<div class="title">Figure 15. Edit organization dialog.</div>
</div>
</div>
<div class="sect3">
<h4 id="_permissions">Permissions</h4>
<div class="paragraph">
<p>Manage permissions by opening the <strong>Permission management</strong> interface using <span class="menuseq"><b class="menu">QuPath Edu</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Manage permissions</b></span>.</p>
</div>
<div class="paragraph">
<p>By default, when creating a new workspace, it is automatically assigned the <strong>Write</strong> access for <strong>yourself</strong> and <strong>Read</strong> access to <strong>no-one</strong>. You can restrict access to either <strong>a)</strong> only yourself, <strong>b)</strong> specific organizations, <strong>c)</strong> specific users, <strong>d)</strong> combination of users and organizations.</p>
</div>
<div class="paragraph">
<p>Simply use <b class="button">&rsaquo;</b>, <b class="button">&raquo;</b><b class="button">&lsaquo;</b> and <b class="button">&laquo;</b> to add/remove permissions. Double-arrows moves <strong>all items</strong> and single-arrows move <strong>only the selected item</strong>. Clicking <b class="button">?</b> will give you an analysis of who has read/write permissions in plain English.</p>
</div>
<div class="paragraph">
<p>Remember to press <b class="button">Save changes</b> <em>(bottom right-hand corner)</em> separately on "Read" and "Write" respectively; currently QuPath Edu gives <strong>no warning</strong> if forgetting to save any changes.</p>
</div>
<div id="img-permission-management" class="imageblock">
<div class="content">
<img src="images/Permission-Management.png" alt="Permission management interface">
</div>
<div class="title">Figure 16. Permission management interface. <strong>1:</strong> List of all workspaces, the organization is specified in parentheses. <strong>2 &amp; 3:</strong> Read &amp; write permissions separated in different tabs. <strong>4 &amp; 5:</strong> Left pane indicates any users/organizations available and right pane indicates users/organizations with active permissions.</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openmicroanatomy_cloud">OpenMicroanatomy Cloud</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Documentation in progress</strong>.</p>
</div>
<div class="paragraph">
<p>Source code and more details are available at <a href="https://github.com/openmicroanatomy/web">openmicroanatomy/web</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openmicroanatomy_server">OpenMicroanatomy Server</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Docker container is still in beta but is stable for production use.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_installation_running">Installation &amp; Running</h3>
<div class="paragraph">
<p>OpenMicroanatomy Server consists of two components: a <strong>HTTP server</strong> which handles authentication, data (slides, projects, backups, etc&#8230;&#8203;) and so on, and of a <strong>tiler</strong> which runs in the background and converts slides into smaller chunks called <strong>tiles</strong>. Without the <strong>tiler</strong> running you cannot upload new slides; this separation of tasks is due to legacy reasons and both components are hopefully bundled together in version 2.0.</p>
</div>
<div class="sect3">
<h4 id="_installation_docker">Installation (Docker)</h4>
<div class="sect4">
<h5 id="_prerequisites_2">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>Server with Docker support</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_installation">Installation</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To get started, download the OpenMicroanatomy Docker configuration: <code>wget <a href="https://raw.githubusercontent.com/openmicroanatomy/hosting/main/docker-compose.yml" class="bare">https://raw.githubusercontent.com/openmicroanatomy/hosting/main/docker-compose.yml</a></code></p>
</li>
<li>
<p><code>cd hosting</code></p>
</li>
<li>
<p>Start the server for the first time using <code>docker-compose run server</code></p>
</li>
<li>
<p>Follow the instructions to create the initial organization and administrator account.</p>
<div class="ulist">
<ul>
<li>
<p>Organization name and administrator account can be edited later</p>
</li>
</ul>
</div>
</li>
<li>
<p>After creating the initial organization and administrator account stop the server by inputting <code>stop</code> into the terminal or by pressing <code>CTRL + A</code> + <code>CTRL + C</code> to exit.</p>
</li>
<li>
<p>Edit the <code>application.conf</code> using e.g. <code>nano</code> or <code>vi</code></p>
<div class="ulist">
<ul>
<li>
<p>Most important step is to configure <code>server.host</code> to match your reverse proxy address; otherwise slides <em>will not work</em> and fixing them later is can be cumbersome&#8201;&#8212;&#8201;see <a href="#_fixing_incorrect_slide_paths">Fixing Incorrect Slide Paths</a>.</p>
</li>
<li>
<p>See <a href="#_configuration">Configuration</a> chapter below for more details.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Start the server using <code>docker-compose up -d</code> which will start both the <strong>Server</strong> and <strong>Tiler</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>If you wish to run OpenMicroanatomy without the <strong>Tiler</strong>, just ccomment the lines for <strong>Tiler</strong> inside <code>docker-compose.yml</code>.</em></p>
</div>
</div>
<div class="sect4">
<h5 id="_updating">Updating</h5>
<div class="paragraph">
<p>OpenMicroanatomy uses semantic versioning <code>MAJOR.MINOR.PATCH</code>, meaning no breaking changes happen unless the major version changes (e.g. from 1.X.X to 2.X.X). If you&#8217;re using <code>:latest</code> (default) as the Docker container version you may accidentally update to a newer major version. It is recommended that you pin your version to e.g. <code>:v1</code> to allow minor and patch upgrades or <code>v1.1</code> to allow only patches by editing  <code>docker-compose.yml</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>docker-compose down</code></p>
</li>
<li>
<p><code>docker pull openmicroanatomy</code></p>
</li>
<li>
<p><code>docker-compose up -d</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_installation_manually">Installation (Manually)</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Manual OpenMicroanatomy installations are no longer supported. Assistance for any issues with manual installations <strong>cannot be guaranteed</strong>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_prerequisites_3">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>Server with Java 14 support</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_installation_2">Installation</h5>
<div class="paragraph">
<p><em>These instructions assume you&#8217;re familiar with Linux already and skips multiple crucial steps such as creating a new user.</em></p>
</div>
<div class="paragraph">
<p>It&#8217;s advised to create a separate user, such as <code>openmicroanatomy</code> and to use software such as <code>screen</code> to create separate sessions for both instances. Both the tiler and server must be running on the same server.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the latest <code>open-microanatomy-server.jar</code> from <a href="https://github.com/openmicroanatomy/server/releases">GitHub</a>.</p>
</li>
<li>
<p>Save it to e.g. <code>/home/openmicroanatomy/server/open-microanatomy-server.jar</code></p>
</li>
<li>
<p>Extract OpenSlide Binaries</p>
<div class="ulist">
<ul>
<li>
<p><em>these are currently only available from the <a href="https://github.com/qupath/qupath/tree/main/maven/repo/org/openslide/openslide/3.4.1_2">QuPath repository</a>&#8201;&#8212;&#8201;download the <code>.jar</code> file specific to your operating system and <strong>extract</strong> it to where you saved <code>qupath-edu-server.jar</code>.</em></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_running_the_server">Running the server</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start the server with <code>java -jar &lt;jar&gt; [-port &lt;port&gt;]</code></p>
</li>
<li>
<p>During your initial start-up, you will create your first administrator account.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_running_the_tiler">Running the tiler</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start the tiler with <code>java -jar &lt;jar&gt; --tiler</code></p>
</li>
<li>
<p>Tiler validates that everything is working as expected and will wait for new slides.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_updating_2">Updating</h5>
<div class="paragraph">
<p>Download the latest <code>open-microanatomy-server.jar</code> from GitHub and restart any running <code>screen</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_systemd_service">Systemd service</h5>
<div class="paragraph">
<p>To start OpenMicroanatomy automatically or restart it in case the process gets killed, you can create a <strong>Systemd</strong> service for it.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration">Configuration</h3>
<div class="paragraph">
<p>Configuration is available at <code>application.conf</code> which will be generated during the initial start-up, it contains comments for instructions. The default configuration has sensible defaults, but you&#8217;re free to tweak anything you wish.</p>
</div>
<div class="paragraph">
<p>The <strong>only required configuration step</strong> is setting the <code>server.host</code> parameter&#8201;&#8212;&#8201;this should point to your reverse proxy address (see <a href="#_ssl">SSL</a> chapter). <strong>Your server <em>will not</em> function properly if you do not set the host parameter.</strong></p>
</div>
<div class="paragraph">
<p>For storing the tiles there are two options. <strong>Flatfile (default)</strong> storage uses the servers disk to store any tiles. For <strong>Cloud storage</strong> currently <strong><a href="https://docs.csc.fi/data/Allas/">CSC Allas</a></strong> is only supported, with initial support for <strong>Amazon S3</strong> existing. If you&#8217;re interested in support for <a href="https://aws.amazon.com/s3/">Amazon S3</a> or any other cloud provider, please create a <a href="https://github.com/openmicroanatomy/server/issues">GitHub issue</a> regarding this.</p>
</div>
<div class="paragraph">
<p>To <strong>generate a new configuration</strong> simply delete the old one and restart the server. To <strong>reload the configuration</strong> you must restart the server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ssl">SSL</h3>
<div class="paragraph">
<p>OpenMicroanatomy does <strong>not</strong> include SSL by default and it is up to the end-user to set up a <strong>reverse proxy</strong> using software such as <a href="https://caddyserver.com/">Caddy</a>, <a href="https://www.nginx.com/">nginx</a> or <a href="https://httpd.apache.org/">Apache</a> to provide a secure connection.</p>
</div>
<div class="sect3">
<h4 id="_no_existing_reverse_proxy">No existing reverse proxy</h4>
<div class="paragraph">
<p>If your DNS includes an automatic SSL proxy option, feel free to try that. Alternatively you can set up your own Caddy server as a reverse proxy or use the provided Caddy Docker container as described below.</p>
</div>
<div class="sect4">
<h5 id="_setting_up_a_caddy_server_using_docker">Setting up a Caddy server using Docker</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Shut down any Docker instances: <code>docker-compose down</code></p>
</li>
<li>
<p>Download the <em>Caddy Docker configuration</em> using <code>wget <a href="https://raw.githubusercontent.com/openmicroanatomy/hosting/main/docker-compose.caddy.yml" class="bare">https://raw.githubusercontent.com/openmicroanatomy/hosting/main/docker-compose.caddy.yml</a></code></p>
</li>
<li>
<p>Edit the <em>Caddy Docker configuration</em>: <code>nano docker-compose.caddy.yml</code></p>
</li>
<li>
<p>Change <code>virtual.host</code> to your domain name without <code>https://</code> e.g.: <code>virtual.host: 'example.com'</code></p>
</li>
<li>
<p>Change <code>virtual.tls-address</code> to your administrator email account e.g. <code>virtual.tls-address: '<a href="mailto:john.smith@example.com">john.smith@example.com</a>'</code>&#8201;&#8212;&#8201;this is not revealed to anyone and only used by CertBot to notify about any issues with the SSL certificate.</p>
</li>
<li>
<p><strong>Save and exit </strong></p>
</li>
<li>
<p>Edit the <em>OpenMicroanatomy Docker configuration</em>: <code>nano docker-compose.yml</code></p>
</li>
<li>
<p>Under <code>ports</code> change <code>- '7777:7777'</code> to <code>- '127.0.0.1:7777:7777</code> to prohibit access using insecure HTTP</p>
</li>
<li>
<p><strong>Save and exit</strong></p>
</li>
<li>
<p>Run <code>docker-compose -f docker-compose.yml -f docker-compose.caddy.yml up -D</code> to restart server</p>
</li>
<li>
<p><strong>Done</strong>: OpenMicroanatomy should be accessible via <code><a href="https://example.com" class="bare">https://example.com</a></code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_existing_reverse_proxy">Existing reverse proxy</h4>
<div class="paragraph">
<p>Configure your existing Apache / nginx server to behave as a reverse proxy for OpenMicroanatomy.</p>
</div>
<div class="paragraph">
<p>Below is an example nginx reverse proxy configuration using <a href="https://certbot.eff.org/">Certbot</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>server {
    server_name open.microanatomy.server;

    access_log /var/log/nginx/reverse-access.log;
    error_log /var/log/nginx/reverse-error.log;

    include /etc/nginx/conf/proxy.conf;

    location / {
        proxy_pass http://127.0.0.1:7777;
    }

    listen [::]:443 ssl;
    listen 443 ssl;
    ssl_certificate /etc/letsencrypt/live/open.microanatomy.server/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/open.microanatomy.server/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
}

server {
    if ($host = open.microanatomy.server) {
        return 301 https://$host$request_uri;
    }

    listen 80;
    listen [::]:80;

    server_name open.microanatomy.server;
    return 404;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_troubleshooting">Troubleshooting</h3>
<div class="sect3">
<h4 id="_fixing_incorrect_slide_paths">Fixing Incorrect Slide Paths</h4>
<div class="paragraph">
<p>Uploading slides with an incorrect <code>server.path</code> inside <code>application.conf</code> will result in QuPath and OpenMicroanatomy Cloud not knowing where the slides are actually stored and making them inaccessible. The <code>server.path</code> is encoded within each slides <code>.properties</code> file when uploaded, thus requiring them to be manually updated if the <code>server.path</code> is changed.</p>
</div>
<div class="paragraph">
<p>To check for any incorrect paths run the following command in the server root directory.</p>
</div>
<div class="paragraph">
<p><code>cd slides &amp;&amp; cat *.properties || grep "&lt;your previous server.path&gt;"</code></p>
</div>
<hr>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Backup slides: <code>cp -R slides slides-backup</code></p>
</li>
<li>
<p>Switch to slides directory: <code>cd slides</code></p>
</li>
<li>
<p>Perform a Search &amp; Replace: <code>sed -i&#8201;&#8212;&#8201;'s/&lt;previous server.path&gt;/&lt;new server.path&gt;/g' *</code></p>
</li>
<li>
<p>Validate that all instances have been replaced: <code>cat *.properties || grep "&lt;your previous server.path&gt;"`</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_http_api">HTTP API</h3>
<div class="paragraph">
<p>OpenMicroanatomy Server includes a <strong>REST API</strong>&#8201;&#8212;&#8201;documentation is available <a href="https://demo.edu.qupath.yli-hallila.fi/swagger">here</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-01-28 11:45:44 +0200
</div>
</div>
</body>
</html>